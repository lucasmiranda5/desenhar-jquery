jQuery.fn.Desenhar=function(t,o,e){var n,a;o||(o=this.width()),e||(e=this.height());var s=new Array,r=new Array,l=new Array,i=new Array,u=new Array,b=new Array,c=!1,m="#000",d="marker",h="normal",p=0,f=0;function v(t,o,e){s.push(t),r.push(o),i.push(d),l.push(m),u.push(h),b.push(e)}function g(){var t,n;"small"==h?t=467:"normal"==h?t=450:"large"==h?t=428:"huge"==h&&(t=399),a.beginPath(),a.rect(t,189,2,12),a.closePath(),a.fillStyle="#333333",a.fill(),a.save(),a.beginPath(),a.rect(p,f,o,e),a.clip();for(var c=0;c<s.length;c++)"small"==u[c]?n=2:"normal"==u[c]?n=5:"large"==u[c]?n=10:"huge"==u[c]?n=20:(alert("Error: Radius is zero for click "+c),n=0),a.beginPath(),b[c]&&c?a.moveTo(s[c-1],r[c-1]):a.moveTo(s[c],r[c]),a.lineTo(s[c],r[c]),a.closePath(),"eraser"==i[c]?a.globalCompositeOperation="destination-out":(a.globalCompositeOperation="source-over",a.strokeStyle=l[c]),a.lineJoin="round",a.lineWidth=n,a.stroke();a.globalCompositeOperation="source-over",a.restore()}(n=document.createElement("canvas")).setAttribute("width",o),n.setAttribute("height",e),n.setAttribute("id",t),this.append(n),"undefined"!=typeof G_vmlCanvasManager&&(n=G_vmlCanvasManager.initElement(n)),a=n.getContext("2d"),$("#"+t).mousedown(function(t){var o=t.pageX-this.offsetLeft,e=t.pageY-this.offsetTop;c=!0,v(o,e,!1),g()}),$("#"+t).mousemove(function(t){1==c&&(v(t.pageX-this.offsetLeft,t.pageY-this.offsetTop,!0),g())}),$("#"+t).mouseup(function(t){c=!1,g()}),$("#"+t).mouseleave(function(t){c=!1,g()}),g(),html='<div id="'+t+'-acoes"><div class="form-group" style="width:45px"><label>Cor</label> <div class="input-group my-colorpicker2"><input type="text" class="form-control color-input" style="display: none" value="#000"><div class="input-group-addon" style="border:1px solid #000"><i></i></div> </div></div><button type="button" class="btn btn-success btn-ferramentas" data-tool="marker">Pincel</button><button type="button" class="btn btn-infor btn-ferramentas" data-tool="eraser">Borracha</button><br><button type="button" class="btn btn-infor btn-tamanho" data-tool="huge">Enorme</button><button type="button" class="btn btn-infor btn-tamanho" data-tool="large">Grade</button> <button type="button" class="btn btn-success btn-tamanho" data-tool="normal">Normal</button><button type="button" class="btn btn-infor btn-tamanho" data-tool="small">Pequeno</button><button type="button" class="btn btn-infor btn-teste" data-tool="small">Pequeno</button></div>',this.before(html),$("#"+t+"-acoes .btn-ferramentas").click(function(){$("#"+t+"-acoes .btn-ferramentas").removeClass("btn-success").addClass("btn-infor"),$(this).removeClass("btn-infor").addClass("btn-success"),d=$(this).attr("data-tool")}),$("#"+t+"-acoes .btn-tamanho").click(function(){$("#"+t+"-acoes .btn-tamanho").removeClass("btn-success").addClass("btn-infor"),$(this).removeClass("btn-infor").addClass("btn-success"),h=$(this).attr("data-tool")}),$("#"+t+"-acoes .my-colorpicker2").colorpicker().on("changeColor",function(o){m=$("#"+t+"-acoes .color-input").val()})};